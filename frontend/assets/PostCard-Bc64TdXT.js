import{j as e,r as o,d as fe}from"./index-BuZGzeB0.js";import{p as te}from"./post.service-_8tU2b1P.js";const xe="https://www.xbullet.me";async function ee(t,n={}){const r=localStorage.getItem("passport_buddy_token"),l=`${xe}${t}`,d=await fetch(l,{credentials:"include",headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`},...n.headers},...n});if(!d.ok){const g=await d.json().catch(()=>({message:"Request failed"}));throw new Error(g.message||`HTTP ${d.status}`)}return d.json()}const le={async toggleBookmark(t){return ee(`/api/v1/posts/${t}/bookmark`,{method:"POST"})},async getBookmarkedPosts(){return ee("/api/v1/posts/bookmarked")},async isBookmarked(t){return(await ee(`/api/v1/posts/${t}/bookmark/status`)).isBookmarked}},ke=({isOpen:t,title:n,message:r,confirmText:l="Confirm",cancelText:d="Cancel",onConfirm:g,onCancel:x,type:m="warning"})=>t?e.jsx("div",{className:"confirm-dialog-overlay",onClick:x,children:e.jsxs("div",{className:"confirm-dialog",onClick:k=>k.stopPropagation(),children:[e.jsxs("div",{className:`confirm-dialog-icon confirm-dialog-icon-${m}`,children:[m==="danger"&&e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M12 9V13M12 17H12.01M4.93 4.93L19.07 19.07M19.07 4.93L4.93 19.07",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),m==="warning"&&e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M12 9V13M12 17H12.01M12 2L2 20H22L12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),m==="info"&&e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M12 16V12M12 8H12.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})]}),e.jsx("h3",{className:"confirm-dialog-title",children:n}),e.jsx("p",{className:"confirm-dialog-message",children:r}),e.jsxs("div",{className:"confirm-dialog-actions",children:[e.jsx("button",{className:"confirm-dialog-button confirm-dialog-button-cancel",onClick:x,children:d}),e.jsx("button",{className:`confirm-dialog-button confirm-dialog-button-confirm confirm-dialog-button-${m}`,onClick:g,children:l})]})]})}):null,pe=(t,n,r={})=>{o.useEffect(()=>{const l=t.current;if(!l)return;const d=new IntersectionObserver(([g])=>{n(g)},{threshold:.5,...r});return d.observe(l),()=>d.disconnect()},[t,n,r])},je=({src:t,thumbnail:n,postId:r,autoplay:l=!1,loop:d=!0,muted:g=!0,aspectRatio:x=16/9,className:m="",onPlay:k,onPause:b})=>{const f=o.useRef(null),S=o.useRef(null),[p,j]=o.useState(!1),[C,K]=o.useState(!!n),[B,G]=o.useState(!1),[E,J]=o.useState(0),[y,D]=o.useState(0),[M,O]=o.useState(g),[I,W]=o.useState(!1),[P,V]=o.useState(!1),[R,Y]=o.useState(!1),[$,Q]=o.useState(!1),[X,L]=o.useState(!1),[_,H]=o.useState(!1),v=o.useCallback(async i=>{try{console.log("ðŸ“Š VIDEO_ANALYTICS: Tracking",i,"for post",r),i==="play"&&!_&&(await te.incrementVideoViews(r),H(!0))}catch(c){console.error("âŒ VIDEO_ANALYTICS: Failed to track",i,c)}},[r,_]),A=o.useCallback(i=>{f.current&&(console.log("ðŸŽ¬ VIDEO_AUTOPLAY: Intersection ratio:",i.intersectionRatio),i.isIntersecting&&i.intersectionRatio>.5?(console.log("ðŸŽ¬ VIDEO_AUTOPLAY: Video is 50%+ visible, starting autoplay"),l&&!B&&T()):(console.log("ðŸŽ¬ VIDEO_AUTOPLAY: Video not sufficiently visible, pausing"),p&&B&&N()))},[l,B,p]);pe(S,A,{threshold:.5});const T=async()=>{const i=f.current;if(i)try{K(!1),await i.play(),j(!0),G(!0),_||await v("play"),k==null||k(),console.log("â–¶ï¸ VIDEO_PLAYER: Started playing")}catch(c){console.error("âŒ VIDEO_PLAYER: Play failed:",c)}},N=()=>{const i=f.current;i&&(i.pause(),j(!1),b==null||b(),console.log("â¸ï¸ VIDEO_PLAYER: Paused"))},z=async()=>{const i=f.current;if(!i||!y)return;const c=i.currentTime;J(c);const u=c/y*100;u>=25&&!P?(V(!0),await v("25%")):u>=50&&!R?(Y(!0),await v("50%")):u>=75&&!$?(Q(!0),await v("75%")):u>=95&&!X&&(L(!0),await v("complete"))},Z=()=>{const i=f.current;i&&(D(i.duration),console.log("ðŸ“Š VIDEO_PLAYER: Loaded metadata, duration:",i.duration))},F=()=>{C?T():p?N():T()},U=i=>{i.stopPropagation();const c=f.current;if(!c)return;const u=!M;c.muted=u,O(u),console.log("ðŸ”Š VIDEO_PLAYER: Mute toggled:",u)},q=i=>{const c=Math.floor(i/60),u=Math.floor(i%60);return`${c}:${u.toString().padStart(2,"0")}`};return e.jsxs("div",{ref:S,className:`video-player-container ${m}`,style:{position:"relative",aspectRatio:x.toString(),backgroundColor:"#000",borderRadius:"8px",overflow:"hidden",cursor:"pointer"},onClick:F,onMouseEnter:()=>W(!0),onMouseLeave:()=>W(!1),"data-testid":"video-player",children:[C&&n&&e.jsxs("div",{className:"video-thumbnail",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2},"data-testid":"video-thumbnail",children:[e.jsx("img",{src:n,alt:"Video preview",style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx("div",{className:"play-overlay",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"60px",height:"60px",backgroundColor:"rgba(0, 0, 0, 0.7)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px"},children:"â–¶ï¸"})]}),e.jsx("video",{ref:f,src:t,muted:M,loop:d,playsInline:!0,preload:"metadata",onTimeUpdate:z,onLoadedMetadata:Z,onPlay:()=>j(!0),onPause:()=>j(!1),style:{width:"100%",height:"100%",objectFit:"cover",display:C?"none":"block"},"data-testid":"video-element"}),!C&&(I||!p)&&e.jsxs("div",{className:"video-controls",style:{position:"absolute",bottom:0,left:0,right:0,background:"linear-gradient(transparent, rgba(0,0,0,0.7))",padding:"20px 15px 15px",display:"flex",alignItems:"center",gap:"10px",color:"white",fontSize:"14px",zIndex:3},onClick:i=>i.stopPropagation(),children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),p?N():T()},style:{background:"none",border:"none",color:"white",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px"},children:p?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("rect",{x:"4",y:"3",width:"3",height:"10",rx:"0.5"}),e.jsx("rect",{x:"9",y:"3",width:"3",height:"10",rx:"0.5"})]}):e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:e.jsx("path",{d:"M4 2.5v11a.5.5 0 00.773.416l8-5.5a.5.5 0 000-.832l-8-5.5A.5.5 0 004 2.5z"})})}),e.jsxs("div",{style:{flex:1,fontSize:"12px"},children:[q(E)," / ",q(y)]}),e.jsx("button",{onClick:U,style:{background:"none",border:"none",color:"white",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px"},children:M?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("path",{d:"M6.717 3.55A.5.5 0 017 4v8a.5.5 0 01-.812.39L3.825 10.5H1.5A.5.5 0 011 10V6a.5.5 0 01.5-.5h2.325l2.363-1.89a.5.5 0 01.529-.06z"}),e.jsx("path",{d:"M11.025 4.025a.5.5 0 01.707 0l.707.707.707-.707a.5.5 0 11.708.708L13.147 5.44l.707.707a.5.5 0 01-.708.708l-.707-.708-.707.708a.5.5 0 01-.708-.708l.708-.707-.708-.707a.5.5 0 010-.708z"})]}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("path",{d:"M6.717 3.55A.5.5 0 017 4v8a.5.5 0 01-.812.39L3.825 10.5H1.5A.5.5 0 011 10V6a.5.5 0 01.5-.5h2.325l2.363-1.89a.5.5 0 01.529-.06z"}),e.jsx("path",{d:"M11.025 3.025c.175.175.35.372.508.588A4.98 4.98 0 0113 8a4.98 4.98 0 01-1.467 4.387c-.158.216-.333.413-.508.588a.5.5 0 01-.708-.708c.15-.15.3-.318.436-.504A3.98 3.98 0 0012 8a3.98 3.98 0 00-1.247-3.763 4.015 4.015 0 00-.436-.504.5.5 0 11.708-.708z"}),e.jsx("path",{d:"M9.025 5.025c.127.127.253.273.371.435A2.99 2.99 0 0110 8a2.99 2.99 0 01-.604 2.54c-.118.162-.244.308-.371.435a.5.5 0 01-.708-.708c.092-.092.184-.2.268-.324A1.99 1.99 0 009 8a1.99 1.99 0 00-.415-1.943 2.016 2.016 0 00-.268-.324.5.5 0 01.708-.708z"})]})})]}),!C&&y>0&&e.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"3px",backgroundColor:"rgba(255, 255, 255, 0.3)",zIndex:4},children:e.jsx("div",{style:{height:"100%",backgroundColor:"#8b5cf6",width:`${E/y*100}%`,transition:"width 0.1s ease"}})})]})};function Ce({post:t,currentUserId:n,onToggleLike:r,onCommentAdded:l,onCommentDeleted:d,onPostDeleted:g}){var oe,ne,ae,ie;const x=fe(),[m,k]=o.useState(0),[b,f]=o.useState(""),[S,p]=o.useState(!1),[j,C]=o.useState(!1),[K,B]=o.useState(0),[G,E]=o.useState(!1),[J,y]=o.useState(!1),[D,M]=o.useState(null),[O,I]=o.useState(!1),[W,P]=o.useState(!1),V=o.useRef(null),R=o.useRef(null),Y=t.images&&t.images.length>0,$=t.videos&&t.videos.length>0,Q=Y||$,X=t.images&&t.images.length>1,[L,_]=o.useState(n?t.likes.includes(n):!1),[H,v]=o.useState(t.likes.length),[A,T]=o.useState(!1),[N,z]=o.useState(!1),[Z,F]=o.useState(!1);o.useEffect(()=>{_(n?t.likes.includes(n):!1),v(t.likes.length)},[t.likes,n]),o.useEffect(()=>{(async()=>{if(n&&t._id)try{const a=await le.isBookmarked(t._id);z(a)}catch{}})()},[t._id,n]),o.useEffect(()=>{const s=a=>{V.current&&!V.current.contains(a.target)&&M(null),R.current&&!R.current.contains(a.target)&&I(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const U=o.useCallback(()=>{t.images&&k(s=>s===0?t.images.length-1:s-1)},[t.images]),q=o.useCallback(()=>{t.images&&k(s=>s===t.images.length-1?0:s+1)},[t.images]),i=s=>{const a=new Date(s),h=Math.floor((new Date().getTime()-a.getTime())/1e3);return h<60?"just now":h<3600?`${Math.floor(h/60)}m ago`:h<86400?`${Math.floor(h/3600)}h ago`:h<604800?`${Math.floor(h/86400)}d ago`:a.toLocaleDateString()},c=o.useCallback(async()=>{if(!(A||!r||!n)){_(s=>!s),v(s=>L?s-1:s+1),T(!0);try{await r(t._id)}catch{_(a=>!a),v(a=>L?a+1:a-1)}finally{T(!1)}}},[A,r,n,t._id,L]),u=()=>{const s=Date.now();s-K<300&&!L&&!A&&(c(),E(!0),setTimeout(()=>E(!1),800)),B(s)},se=async()=>{if(!(!b.trim()||S||!n)){p(!0);try{const s=await te.addComment(t._id,b.trim());s.status==="success"&&l&&(l(t._id,s.comment),f(""),C(!0))}catch{}finally{p(!1)}}},ce=async s=>{if(!(!n||!d))try{(await te.deleteComment(t._id,s)).status==="success"&&d(t._id,s)}catch{}},de=o.useCallback(async()=>{var a;const s=`${window.location.origin}/post/${t._id}`;if(navigator.share)try{await navigator.share({title:`Post by ${((a=t.author)==null?void 0:a.username)||"user"}`,text:t.content||"Check out this post!",url:s})}catch(w){w.name}else try{await navigator.clipboard.writeText(s),y(!0),setTimeout(()=>y(!1),2e3)}catch{}},[t._id,(oe=t.author)==null?void 0:oe.username,t.content]),ue=o.useCallback(async()=>{P(!0),I(!1)},[]),he=()=>{g&&g(t._id),P(!1)},me=async()=>{if(!n){x("/auth");return}if(!Z){F(!0),z(!N);try{await le.toggleBookmark(t._id)}catch{z(N)}finally{F(!1)}}};return e.jsxs("article",{className:"post-card",children:[e.jsxs("header",{className:"post-header",children:[e.jsxs("div",{className:"post-author",children:[e.jsx("div",{style:{width:"32px",height:"32px",cursor:"pointer"},onClick:()=>{var s;return((s=t.author)==null?void 0:s.username)&&x(`/profile/${t.author.username}`)},children:(ne=t.author)!=null&&ne.avatar?e.jsx("img",{src:t.author.avatar,alt:`${t.author.username}'s avatar`,style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover"}}):e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"600",fontSize:"14px",backgroundColor:"var(--pb-medium-purple)"},children:(()=>{var w,h;const s=((w=t.author)==null?void 0:w.fullName)||((h=t.author)==null?void 0:h.username)||"User",a=s.split(" ");return a.length>1?`${a[0].charAt(0)}${a[a.length-1].charAt(0)}`.toUpperCase():s.charAt(0).toUpperCase()})()})}),e.jsxs("div",{className:"author-info",children:[e.jsx("h3",{className:"author-username",onClick:s=>{var a;s.stopPropagation(),(a=t.author)!=null&&a.username&&x(`/profile/${t.author.username}`)},style:{cursor:"pointer"},children:((ae=t.author)==null?void 0:ae.username)||"anonymous"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("time",{className:"post-time",children:i(t.createdAt)}),t.location&&e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"3px",backgroundColor:"#f3f4f6",color:"#6b7280",fontSize:"11px",padding:"3px 10px",borderRadius:"14px",marginLeft:"8px",fontWeight:"500"},children:[e.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),e.jsx("span",{children:t.location.name})]})]})]})]}),n&&((ie=t.author)==null?void 0:ie._id)===n&&e.jsxs("div",{className:"post-menu-container",ref:R,children:[e.jsx("button",{className:"post-options","aria-label":"Post options",onClick:()=>I(!O),children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{cx:"5",cy:"12",r:"2",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),e.jsx("circle",{cx:"19",cy:"12",r:"2",fill:"currentColor"})]})}),O&&e.jsx("div",{className:"post-dropdown",children:e.jsx("button",{className:"post-dropdown-item",onClick:ue,children:"Delete Post"})})]})]}),t.content&&e.jsx("div",{className:"post-content",onClick:u,children:e.jsx("p",{className:"post-text",children:t.content})}),Q&&e.jsx("div",{className:"post-media",children:e.jsxs("div",{className:"image-container",onClick:$?void 0:u,children:[$?e.jsx(je,{src:t.videos[0].url,thumbnail:t.videos[0].thumbnail,postId:t._id,autoplay:!1,loop:!0,muted:!0,aspectRatio:t.videos[0].aspectRatio||16/9,className:"post-video"}):Y?e.jsx("img",{src:t.images[m].url,alt:`Post image ${m+1}`,className:"post-image"}):null,G&&e.jsx("div",{className:"like-animation",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"#8b5cf6",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),X&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"image-nav image-nav-prev",onClick:U,"aria-label":"Previous image",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{className:"image-nav image-nav-next",onClick:q,"aria-label":"Next image",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M9 18L15 12L9 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:"image-indicators",children:t.images.map((s,a)=>e.jsx("span",{className:`indicator ${a===m?"active":""}`,onClick:()=>k(a)},a))})]})]})}),e.jsxs("div",{className:"post-actions",children:[e.jsxs("div",{className:"actions-left",children:[e.jsx("button",{className:"action-button","aria-label":"Like",onClick:c,disabled:A,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:L?"#8b5cf6":"none",className:A?"pending-like":"",children:e.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",stroke:L?"#8b5cf6":"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{className:"action-button","aria-label":"Comment",onClick:()=>C(!j),children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M20.656 17.008a9.993 9.993 0 1 0-3.59 3.615L22 22l-1.344-4.992Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{className:"action-button","aria-label":"Share",onClick:de,children:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("path",{d:"M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 6.65685 16.3431 8 18 8Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M6 15C7.65685 15 9 13.6569 9 12C9 10.3431 7.65685 9 6 9C4.34315 9 3 10.3431 3 12C3 13.6569 4.34315 15 6 15Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M18 22C19.6569 22 21 20.6569 21 19C21 17.3431 19.6569 16 18 16C16.3431 16 15 17.3431 15 19C15 20.6569 16.3431 22 18 22Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M8.59 13.51L15.42 17.49",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M15.41 6.51L8.59 10.49",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),J&&e.jsx("div",{className:"copied-message",children:"Link copied!"})]}),e.jsx("button",{className:"action-button","aria-label":"Save",onClick:me,disabled:Z,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:N?"var(--pb-medium-purple)":"none",children:e.jsx("path",{d:"M19 21L12 16L5 21V5C5 4.46957 5.21071 3.96086 5.58579 3.58579C5.96086 3.21071 6.46957 3 7 3H17C17.5304 3 18.0391 3.21071 18.4142 3.58579C18.7893 3.96086 19 4.46957 19 5V21Z",stroke:N?"var(--pb-medium-purple)":"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),e.jsxs("div",{className:"post-stats",children:[e.jsxs("button",{className:"likes-count",children:[H," ",H===1?"like":"likes"]}),t.comments.length>0&&e.jsxs("button",{className:"comments-count",onClick:()=>C(!j),children:[t.comments.length," ",t.comments.length===1?"comment":"comments"]})]}),j&&t.comments.length>0&&e.jsx("div",{className:"comments-section",children:t.comments.map(s=>{var a,w,h;return e.jsxs("div",{className:"comment",children:[e.jsxs("div",{className:"comment-header",children:[e.jsxs("div",{className:"comment-author",children:[e.jsx("span",{className:"comment-username",onClick:ge=>{var re;ge.stopPropagation(),(re=s.author)!=null&&re.username&&x(`/profile/${s.author.username}`)},style:{cursor:"pointer"},children:((a=s.author)==null?void 0:a.username)||"anonymous"}),e.jsx("span",{className:"comment-time",children:i(s.createdAt)})]}),n&&(((w=s.author)==null?void 0:w._id)===n||((h=t.author)==null?void 0:h._id)===n)&&e.jsxs("div",{className:"comment-menu-container",ref:D===s._id?V:null,children:[e.jsx("button",{className:"comment-menu-button",onClick:()=>M(D===s._id?null:s._id),"aria-label":"Comment options",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{cx:"5",cy:"12",r:"2",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),e.jsx("circle",{cx:"19",cy:"12",r:"2",fill:"currentColor"})]})}),D===s._id&&e.jsx("div",{className:"comment-dropdown",children:e.jsx("button",{className:"comment-dropdown-item",onClick:()=>{ce(s._id),M(null)},children:"Delete"})})]})]}),e.jsx("p",{className:"comment-content",children:s.content})]},s._id)})}),j&&e.jsxs("div",{className:"add-comment",children:[e.jsx("input",{type:"text",placeholder:"Add a comment...",className:"comment-input",value:b,onChange:s=>f(s.target.value),onKeyPress:s=>{s.key==="Enter"&&se()},disabled:!n||S}),e.jsx("button",{className:"comment-post",disabled:!b.trim()||!n||S,onClick:se,children:S?"Posting...":"Post"})]}),e.jsx(ke,{isOpen:W,title:"Delete Post?",message:"This action cannot be undone. Are you sure you want to delete this post?",confirmText:"Delete",cancelText:"Cancel",type:"danger",onConfirm:he,onCancel:()=>P(!1)})]})}const be=o.memo(Ce,(t,n)=>{var r,l;return t.post._id===n.post._id&&t.post.likes.length===n.post.likes.length&&t.post.content===n.post.content&&t.post.comments.length===n.post.comments.length&&t.currentUserId===n.currentUserId&&((r=t.post.author)==null?void 0:r._id)===((l=n.post.author)==null?void 0:l._id)});export{ke as C,be as P,le as b};
